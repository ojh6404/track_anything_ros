<launch>

  <arg name="ns" default="track_anything" />
  <arg name="model_type" default="vit_b" />
  <arg name="device" default="cuda:0" />
  <arg name="input_image" default="/zed/zed_node/rgb/image_rect_color"/>
  <arg name="processed_image" default="resized_image_color"/>
  <arg name="input_point" default="resized_image_color/screenpoint" />
  <arg name="output_image" default="segmented_image" />
  <arg name="width" default="640"/>
  <arg name="height" default="480"/>

  <include file="$(find track_anything_ros)/launch/include/resize.launch" >
    <arg name="width" value="$(arg width)" />
    <arg name="height" value="$(arg height)" />
    <arg name="ns" value="$(arg ns)" />
    <arg name="input" value="$(arg input_image)" />
  </include>

  <group ns='$(arg ns)'>
    <node name="tracking_node"
          pkg="track_anything_ros" type="track_node.py"
          output="screen" >
      <remap from="~input_image" to="$(arg processed_image)" />
      <remap from="~input_point" to="$(arg input_point)" />
      <remap from="~output_image" to="$(arg output_image)" />
      <rosparam subst_value="true" >
        device: $(arg device)
        model_type: $(arg model_type)
        model_dir: $(find track_anything_ros)/checkpoints/
      </rosparam>
    </node>

    <!-- <node pkg="jsk_rqt_plugins" type="rqt_image_view2" name="$(anon rqt_image_view2)" -->
    <node pkg="jsk_rqt_plugins" type="rqt_image_view2" name="prompter"
          output="screen">
      <remap from="event" to="image_view2/event" />
      <remap from="image_marked" to="image_marked" />
    </node>
    <node pkg="image_view2" type="image_view2" name="image_view2"
          output="screen">
      <remap from="image" to="$(arg processed_image)" />
      <param name="use_window" value="false" />
    </node>

    <node name="image_view" pkg="image_view" type="image_view" respawn="false" output="screen">
    <remap from="image" to="$(arg output_image)" />
    </node>

    <node name="track_anything_button"
          pkg="jsk_rqt_plugins" type="rqt_tabbed_buttons" output="screen" clear_params="true">
      <rosparam command="load" file="$(find track_anything_ros)/resource/remote_tabbed_layout.yaml" />
    </node>
  </group>
</launch>
